<!DOCTYPE html>
<html>
<head>
  <title>Universal Website Scraper</title>
  <style>
    body { font-family: Arial; margin: 40px; background: #f9fafb }
    .card { background: white; padding: 20px; border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0,0,0,.1); max-width: 900px }
    button { padding: 8px 14px; border: none; border-radius: 6px;
             background: #2563eb; color: white; cursor: pointer }
    input { padding: 8px; width: 65% }
    pre { white-space: pre-wrap; font-size: 13px }
    .loading { color: #2563eb; font-weight: bold }
  </style>
</head>
<body>

<div class="card">
  <h2>Universal Website Scraper</h2>

  <input id="url" placeholder="https://example.com" />
  <button onclick="scrape()">Scrape</button>
  <button onclick="download()">Download JSON</button>

  <p id="status"></p>
  <pre id="output"></pre>
</div>

<script>
let lastResult = null;

async function scrape() {
  const url = document.getElementById("url").value;
  const status = document.getElementById("status");
  const output = document.getElementById("output");

  if (!url) return alert("Enter URL");

  status.textContent = "Scraping...";
  status.className = "loading";
  output.textContent = "";

  const res = await fetch("/scrape", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ url })
  });

  const data = await res.json();
  lastResult = data;

  status.textContent = "Done";
  status.className = "";
  output.textContent = JSON.stringify(data, null, 2);
}

function download() {
  if (!lastResult) return alert("Nothing to download");

  const blob = new Blob(
    [JSON.stringify(lastResult, null, 2)],
    { type: "application/json" }
  );
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "scrape.json";
  a.click();
}
</script>

</body>
</html>
